<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced Media Player</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .player-container {
            background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.5);
            border-radius: 20px;
            transition: all 0.3s ease;
            overflow: hidden;
        }
        .player-container:hover {
            box-shadow: 0 25px 60px rgba(0, 0, 0, 0.6);
            transform: translateY(-2px);
        }
        .media-container {
            position: relative;
            width: 100%;
            aspect-ratio: 16/9;
            background: #000;
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 1rem;
        }
        #video-player, #audio-cover {
            width: 100%;
            height: 8100%;
            object-fit: contain;
        }
        #audio-cover {
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(45deg, #3b82f6, #8b5cf6);
        }
        .progress-container {
            height: 6px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            cursor: pointer;
            position: relative;
        }
        .progress-bar::after {
            content: '';
            position: absolute;
            right: 0;
            top: 50%;
            transform: translateY(-50%);
            width: 12px;
            height: 12px;
            background: white;
            border-radius: 50%;
            opacity: 0;
            transition: opacity 0.2s;
        }
        .progress-container:hover .progress-bar::after {
            opacity: 1;
            margin: 1rem 0;
        }
        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #3b82f6 0%, #8b5cf6 100%);
            border-radius: 3px;
            transition: width 0.1s linear;
        }
        .playlist-item {
            transition: all 0.2s ease;
            border-left: 3px solid transparent;
            padding: 0.75rem 1rem;
        }
        .playlist-item:hover {
            background: rgba(255, 255, 255, 0.05);
            border-left: 3px solid #3b82f6;
            transform: translateX(5px);
        }
        .playlist-item.active {
            background: rgba(59, 130, 246, 0.15);
            border-left: 3px solid #3b82f6;
        }
        .controls {
            display: flex;
            gap: 1rem;
            align-items: center;
            padding: 0.5rem 0;
        }
        .control-btn {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s;
        }
        .control-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(1.1);
        }
        .control-btn.play-pause {
            background: #3b82f6;
            width: 50px;
            height: 50px;
        }
        .control-btn.play-pause:hover {
            background: #2563eb;
        }
        .volume-container {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-left: auto;
        }
        .volume-slider {
            -webkit-appearance: none;
            width: 14px;
            height: 4px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 2px;
            transition: all 0.2s;
        }
        .volume-slider:hover {
            height: 6px;
        }
        .volume-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 12px;
            height: 12px;
            background: #fff;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.2s;
        }
        .volume-slider::-webkit-slider-thumb:hover {
            transform: scale(1.2);
        }
        .dropzone {
            border: 2px dashed rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            transition: all 0.3s ease;
            padding: 2rem;
            text-align: center;
        }
        .dropzone.active {
            border-color: #3b82f6;
            background: rgba(59, 130, 246, 0.1);
            transform: scale(0.99);
        }
        .media-info {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }
        .time-display {
            display: flex;
            justify-content: space-between;
            font-size: 0.8rem;
            color: rgba(255, 255, 255, 0.7);
        }
        .playback-controls {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-top: 0.5rem;
        }
        .fullscreen-btn {
            margin-left: auto;
        }
        @media (max-width: 768px) {
            .player-container {
                border-radius: 0;
            }
            .flex-col.md\:flex-row {
                flex-direction: column;
            }
            .w-full.md\:w-64 {
                width: 100%;
            }
        }
    </style>
</head>
<body class="bg-gray-900 text-gray-100 min-h-screen flex items-center justify-center p-4">
    <div class="player-container w-full max-w-4xl p-6">
        <h1 class="text-2xl font-bold mb-6 text-center">Advanced Media Player</h1>
        
        <div class="flex flex-col md:flex-row gap-6">
            <!-- Player Section -->
            <div class="flex-1">
                <div class="bg-gray-800 rounded-lg p-4 mb-4">
                    <div class="media-container">
                        <video id="video-player" class="hidden" controls></video>
                        <div id="audio-cover">
                            <i class="fas fa-music text-6xl text-white" id="cover-icon"></i>
                        </div>
                    </div>
                    
                    <div class="media-info">
                        <h2 class="text-xl font-semibold truncate" id="now-playing">No media selected</h2>
                        <p class="text-gray-400 text-sm truncate" id="media-source"></p>
                    </div>
                    
                    <div class="progress-container" id="progress-container">
                        <div class="progress-bar" id="progress-bar"></div>
                    </div>
                    <div class="time-display">
                        <span id="current-time">0:00</span>
                        <span id="duration">0:00</span>
                    </div>
                    
                    <div class="controls">
                        <button class="control-btn" id="prev-btn" title="Previous">
                            <i class="fas fa-step-backward"></i>
                        </button>
                        <button class="control-btn play-pause" id="play-btn" title="Play/Pause">
                            <i class="fas fa-play" id="play-icon"></i>
                        </button>
                        <button class="control-btn" id="next-btn" title="Next">
                            <i class="fas fa-step-forward"></i>
                        </button>
                        
                        <div class="volume-container">
                            <i class="fas fa-volume-up"></i>
                            <input type="range" min="0" max="1" step="0.01" value="0.7" 
                                   class="volume-slider" id="volume" title="Volume">
                        </div>
                    </div>
                    
                    <div class="playback-controls">
                        <span class="text-sm">Speed:</span>
                        <select class="bg-gray-700 rounded px-2 py-1 text-sm" id="playback-rate">
                            <option value="0.5">0.5x</option>
                            <option value="0.75">0.75x</option>
                            <option value="1" selected>1x</option>
                            <option value="1.25">1.25x</option>
                            <option value="1.5">1.5x</option>
                            <option value="2">2x</option>
                        </select>
                        
                        <button class="control-btn fullscreen-btn hidden" id="fullscreen-btn" title="Fullscreen">
                            <i class="fas fa-expand"></i>
                        </button>
                    </div>
                </div>
                
                <!-- Input Section -->
                <div class="bg-gray-800 rounded-lg p-4">
                    <div class="dropzone p-6 text-center mb-4" id="dropzone">
                        <i class="fas fa-cloud-upload-alt text-3xl mb-2 text-blue-500"></i>
                        <p class="mb-2">Drag & drop media files or .txt files here</p>
                        <p class="text-sm text-gray-400">Supports: MP3, MP4, WebM, OGG, and .txt with URLs</p>
                    </div>
                    
                    <div class="flex gap-2 mb-4">
                        <input type="text" id="media-url" placeholder="Enter media URL or .txt URL" 
                               class="flex-1 bg-gray-700 rounded px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <button id="add-url" class="bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded">
                            <i class="fas fa-plus"></i> Add
                        </button>
                    </div>
                    
                    <div class="flex gap-2">
                        <button id="load-sample" class="bg-gray-700 hover:bg-gray-600 px-4 py-2 rounded text-sm">
                            <i class="fas fa-music"></i> Load Sample
                        </button>
                        <button id="clear-all" class="bg-red-600 hover:bg-red-700 px-4 py-2 rounded text-sm">
                            <i class="fas fa-trash"></i> Clear All
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Playlist Section -->
            <div class="w-full md:w-64 bg-gray-800 rounded-lg p-4">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="font-semibold">Playlist</h3>
                    <span class="text-xs bg-gray-700 px-2 py-1 rounded" id="playlist-count">0 items</span>
                </div>
                
                <div class="overflow-y-auto max-h-96" id="playlist">
                    <p class="text-gray-400 text-center py-4">Your playlist is empty</p>
                </div>
            </div>
        </div>
        
        <audio id="audio-player"></audio>
        <script>
            document.addEventListener('DOMContentLoaded', function() {
                // DOM Elements
                const audioPlayer = document.getElementById('audio-player');
                const videoPlayer = document.getElementById('video-player');
                const mediaContainer = document.querySelector('.media-container');
                const playBtn = document.getElementById('play-btn');
                const playIcon = document.getElementById('play-icon');
                const prevBtn = document.getElementById('prev-btn');
                const nextBtn = document.getElementById('next-btn');
                const progressBar = document.getElementById('progress-bar');
                const progressContainer = document.getElementById('progress-container');
                const currentTimeEl = document.getElementById('current-time');
                const durationEl = document.getElementById('duration');
                const volumeSlider = document.getElementById('volume');
                const playbackRate = document.getElementById('playback-rate');
                const nowPlayingEl = document.getElementById('now-playing');
                const mediaSourceEl = document.getElementById('media-source');
                const coverIcon = document.getElementById('cover-icon');
                const fullscreenBtn = document.getElementById('fullscreen-btn');
                const playlistEl = document.getElementById('playlist');
                const playlistCountEl = document.getElementById('playlist-count');
                const mediaUrlInput = document.getElementById('media-url');
                const addUrlBtn = document.getElementById('add-url');
                const loadSampleBtn = document.getElementById('load-sample');
                const clearAllBtn = document.getElementById('clear-all');
                const dropzone = document.getElementById('dropzone');
                
                // Player state
                let playlist = [];
                let currentTrackIndex = -1;
                let isPlaying = false;
                let isVideo = false;
                
                // Initialize player
                function initPlayer() {
                    updatePlaylistCount();
                    updatePlaylistUI();
                    
                    // Event listeners
                    playBtn.addEventListener('click', togglePlay);
                    prevBtn.addEventListener('click', prevTrack);
                    nextBtn.addEventListener('click', nextTrack);
                    progressContainer.addEventListener('click', setProgress);
                    volumeSlider.addEventListener('input', setVolume);
                    playbackRate.addEventListener('change', setPlaybackRate);
                    addUrlBtn.addEventListener('click', addMediaFromInput);
                    loadSampleBtn.addEventListener('click', loadSamplePlaylist);
                    clearAllBtn.addEventListener('click', clearPlaylist);
                    fullscreenBtn.addEventListener('click', toggleFullscreen);
                    
                    mediaUrlInput.addEventListener('keypress', function(e) {
                        if (e.key === 'Enter') addMediaFromInput();
                    });
                    
                    // Drag and drop events
                    ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                        dropzone.addEventListener(eventName, preventDefaults, false);
                    });
                    
                    function preventDefaults(e) {
                        e.preventDefault();
                        e.stopPropagation();
                    }
                    
                    ['dragenter', 'dragover'].forEach(eventName => {
                        dropzone.addEventListener(eventName, highlight, false);
                    });
                    
                    ['dragleave', 'drop'].forEach(eventName => {
                        dropzone.addEventListener(eventName, unhighlight, false);
                    });
                    
                    function highlight() {
                        dropzone.classList.add('active');
                    }
                    
                    function unhighlight() {
                        dropzone.classList.remove('active');
                    }
                    
                    dropzone.addEventListener('drop', handleDrop, false);
                    
                    // Media player events
                    audioPlayer.addEventListener('timeupdate', updateProgress);
                    audioPlayer.addEventListener('ended', nextTrack);
                    audioPlayer.addEventListener('play', updatePlayState);
                    audioPlayer.addEventListener('pause', updatePlayState);
                    audioPlayer.addEventListener('loadedmetadata', updateMediaInfo);
                    
                    videoPlayer.addEventListener('timeupdate', updateProgress);
                    videoPlayer.addEventListener('ended', nextTrack);
                    videoPlayer.addEventListener('play', updatePlayState);
                    videoPlayer.addEventListener('pause', updatePlayState);
                    videoPlayer.addEventListener('loadedmetadata', updateMediaInfo);
                    videoPlayer.addEventListener('fullscreenchange', updateFullscreenButton);
                }
                
                // Playlist management
                function addToPlaylist(url, name = null) {
                    // Check if URL is a .txt file
                    if (url.toLowerCase().endsWith('.txt')) {
                        fetchTxtFile(url);
                        return;
                    }
                    
                    const id = Date.now();
                    const fileName = name || url.split('/').pop().split('?')[0];
                    const isVideoFile = /\.(mp4|webm|ogg|mov|avi|mkv)$/i.test(url);
                    
                    playlist.push({
                        id,
                        url,
                        name: fileName,
                        isVideo: isVideoFile
                    });
                    
                    updatePlaylistCount();
                    updatePlaylistUI();
                    
                    // If this is the first item, play it
                    if (playlist.length === 1) {
                        currentTrackIndex = 0;
                        loadTrack(currentTrackIndex);
                    }
                }
                
                async function fetchTxtFile(url) {
                    try {
                        const response = await fetch(url);
                        if (!response.ok) throw new Error('Failed to fetch .txt file');
                        
                        const text = await response.text();
                        const urls = text.split('\n')
                            .map(line => line.trim())
                            .filter(line => line.length > 0 && !line.startsWith('#'));
                        
                        if (urls.length === 0) {
                            alert('The .txt file contains no valid URLs');
                            return;
                        }
                        
                        urls.forEach(url => addToPlaylist(url));
                    } catch (error) {
                        console.error('Error loading .txt file:', error);
                        alert('Failed to load .txt file: ' + error.message);
                    }
                }
                
                function loadTrack(index) {
                    if (index < 0 || index >= playlist.length) return;
                    
                    const track = playlist[index];
                    isVideo = track.isVideo;
                    
                    if (isVideo) {
                        audioPlayer.pause();
                        audioPlayer.src = '';
                        videoPlayer.src = track.url;
                        videoPlayer.classList.remove('hidden');
                        coverIcon.parentElement.classList.add('hidden');
                        fullscreenBtn.classList.remove('hidden');
                    } else {
                        videoPlayer.pause();
                        videoPlayer.src = '';
                        videoPlayer.classList.add('hidden');
                        coverIcon.parentElement.classList.remove('hidden');
                        fullscreenBtn.classList.add('hidden');
                        audioPlayer.src = track.url;
                    }
                    
                    nowPlayingEl.textContent = track.name;
                    mediaSourceEl.textContent = track.url;
                    
                    if (isPlaying) {
                        isVideo ? videoPlayer.play() : audioPlayer.play();
                    }
                    
                    updatePlaylistUI();
                }
                
                function togglePlay() {
                    if (playlist.length === 0) return;
                    
                    if (currentTrackIndex === -1) {
                        currentTrackIndex = 0;
                        loadTrack(currentTrackIndex);
                    }
                    
                    if (isPlaying) {
                        isVideo ? videoPlayer.pause() : audioPlayer.pause();
                    } else {
                        isVideo ? videoPlayer.play() : audioPlayer.play();
                    }
                }
                
                function updatePlayState() {
                    isPlaying = isVideo ? !videoPlayer.paused : !audioPlayer.paused;
                    playIcon.className = isPlaying ? 'fas fa-pause' : 'fas fa-play';
                }
                
                // ... (rest of the JavaScript remains similar but updated to handle both players)
                
                // Fullscreen control
                function toggleFullscreen() {
                    if (!isVideo) return;
                    
                    if (!document.fullscreenElement) {
                        mediaContainer.requestFullscreen().catch(err => {
                            console.error(`Error attempting to enable fullscreen: ${err.message}`);
                        });
                    } else {
                        document.exitFullscreen();
                    }
                }
                
                function updateFullscreenButton() {
                    const icon = fullscreenBtn.querySelector('i');
                    icon.className = document.fullscreenElement ? 'fas fa-compress' : 'fas fa-expand';
                }
                
                // Initialize the player
                initPlayer();
            });
        </script>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // DOM Elements
            const audioPlayer = document.getElementById('audio-player');
            const playBtn = document.getElementById('play-btn');
            const prevBtn = document.getElementById('prev-btn');
            const nextBtn = document.getElementById('next-btn');
            const progressBar = document.getElementById('progress-bar');
            const progressContainer = document.getElementById('progress-container');
            const currentTimeEl = document.getElementById('current-time');
            const durationEl = document.getElementById('duration');
            const volumeSlider = document.getElementById('volume');
            const playbackRate = document.getElementById('playback-rate');
            const nowPlayingEl = document.getElementById('now-playing');
            const mediaSourceEl = document.getElementById('media-source');
            const coverIcon = document.getElementById('cover-icon');
            const coverImage = document.getElementById('cover-image');
            const playlistEl = document.getElementById('playlist');
            const playlistCountEl = document.getElementById('playlist-count');
            const mediaUrlInput = document.getElementById('media-url');
            const addUrlBtn = document.getElementById('add-url');
            const loadSampleBtn = document.getElementById('load-sample');
            const clearAllBtn = document.getElementById('clear-all');
            const dropzone = document.getElementById('dropzone');
            
            // Player state
            let playlist = [];
            let currentTrackIndex = -1;
            let isPlaying = false;
            
            // Initialize player
            function initPlayer() {
                updatePlaylistCount();
                updatePlaylistUI();
                
                // Event listeners
                playBtn.addEventListener('click', togglePlay);
                prevBtn.addEventListener('click', prevTrack);
                nextBtn.addEventListener('click', nextTrack);
                progressContainer.addEventListener('click', setProgress);
                volumeSlider.addEventListener('input', setVolume);
                playbackRate.addEventListener('change', setPlaybackRate);
                addUrlBtn.addEventListener('click', addMediaFromInput);
                loadSampleBtn.addEventListener('click', loadSamplePlaylist);
                clearAllBtn.addEventListener('click', clearPlaylist);
                mediaUrlInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') addMediaFromInput();
                });
                
                // Drag and drop events
                ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                    dropzone.addEventListener(eventName, preventDefaults, false);
                });
                
                function preventDefaults(e) {
                    e.preventDefault();
                    e.stopPropagation();
                }
                
                ['dragenter', 'dragover'].forEach(eventName => {
                    dropzone.addEventListener(eventName, highlight, false);
                });
                
                ['dragleave', 'drop'].forEach(eventName => {
                    dropzone.addEventListener(eventName, unhighlight, false);
                });
                
                function highlight() {
                    dropzone.classList.add('active');
                }
                
                function unhighlight() {
                    dropzone.classList.remove('active');
                }
                
                dropzone.addEventListener('drop', handleDrop, false);
                
                // Audio player events
                audioPlayer.addEventListener('timeupdate', updateProgress);
                audioPlayer.addEventListener('ended', nextTrack);
                audioPlayer.addEventListener('play', () => {
                    isPlaying = true;
                    updatePlayButton();
                });
                audioPlayer.addEventListener('pause', () => {
                    isPlaying = false;
                    updatePlayButton();
                });
                audioPlayer.addEventListener('loadedmetadata', updateMediaInfo);
            }
            
            // Playlist management
            function addToPlaylist(url, name = null) {
                // Check if URL is a .txt file
                if (url.toLowerCase().endsWith('.txt')) {
                    fetchTxtFile(url);
                    return;
                }
                
                const id = Date.now();
                const fileName = name || url.split('/').pop().split('?')[0];
                
                playlist.push({
                    id,
                    url,
                    name: fileName
                });
                
                updatePlaylistCount();
                updatePlaylistUI();
                
                // If this is the first item, play it
                if (playlist.length === 1) {
                    currentTrackIndex = 0;
                    loadTrack(currentTrackIndex);
                }
            }
            
            async function fetchTxtFile(url) {
                try {
                    const response = await fetch(url);
                    if (!response.ok) throw new Error('Failed to fetch .txt file');
                    
                    const text = await response.text();
                    const urls = text.split('\n')
                        .map(line => line.trim())
                        .filter(line => line.length > 0 && !line.startsWith('#'));
                    
                    if (urls.length === 0) {
                        alert('The .txt file contains no valid URLs');
                        return;
                    }
                    
                    urls.forEach(url => addToPlaylist(url));
                } catch (error) {
                    console.error('Error loading .txt file:', error);
                    alert('Failed to load .txt file: ' + error.message);
                }
            }
            
            function removeFromPlaylist(id) {
                const index = playlist.findIndex(item => item.id === id);
                if (index === -1) return;
                
                playlist.splice(index, 1);
                
                // Adjust current track index if needed
                if (currentTrackIndex >= index && currentTrackIndex > 0) {
                    currentTrackIndex--;
                }
                
                // If we removed the currently playing track
                if (index === currentTrackIndex) {
                    if (playlist.length > 0) {
                        loadTrack(Math.min(currentTrackIndex, playlist.length - 1));
                    } else {
                        currentTrackIndex = -1;
                        audioPlayer.src = '';
                        nowPlayingEl.textContent = 'No media selected';
                        mediaSourceEl.textContent = '';
                        coverIcon.classList.remove('hidden');
                        coverImage.classList.add('hidden');
                    }
                }
                
                updatePlaylistCount();
                updatePlaylistUI();
            }
            
            function clearPlaylist() {
                if (playlist.length === 0) return;
                
                if (confirm('Are you sure you want to clear the playlist?')) {
                    playlist = [];
                    currentTrackIndex = -1;
                    audioPlayer.src = '';
                    isPlaying = false;
                    updatePlayButton();
                    nowPlayingEl.textContent = 'No media selected';
                    mediaSourceEl.textContent = '';
                    coverIcon.classList.remove('hidden');
                    coverImage.classList.add('hidden');
                    updatePlaylistCount();
                    updatePlaylistUI();
                }
            }
            
            function updatePlaylistCount() {
                playlistCountEl.textContent = `${playlist.length} ${playlist.length === 1 ? 'item' : 'items'}`;
            }
            
            function updatePlaylistUI() {
                if (playlist.length === 0) {
                    playlistEl.innerHTML = '<p class="text-gray-400 text-center py-4">Your playlist is empty</p>';
                    return;
                }
                
                playlistEl.innerHTML = '';
                playlist.forEach((item, index) => {
                    const itemEl = document.createElement('div');
                    itemEl.className = `playlist-item p-3 mb-1 rounded cursor-pointer flex justify-between items-center ${index === currentTrackIndex ? 'active' : ''}`;
                    itemEl.innerHTML = `
                        <div class="truncate flex-1">${item.name}</div>
                        <button class="text-red-400 hover:text-red-300 ml-2" data-id="${item.id}">
                            <i class="fas fa-times"></i>
                        </button>
                    `;
                    
                    itemEl.addEventListener('click', () => {
                        currentTrackIndex = index;
                        loadTrack(currentTrackIndex);
                        if (isPlaying) {
                            audioPlayer.play();
                        }
                        updatePlaylistUI();
                    });
                    
                    const removeBtn = itemEl.querySelector('button');
                    removeBtn.addEventListener('click', (e) => {
                        e.stopPropagation();
                        removeFromPlaylist(item.id);
                    });
                    
                    playlistEl.appendChild(itemEl);
                });
            }
            
            // Player controls
            function loadTrack(index) {
                if (index < 0 || index >= playlist.length) return;
                
                const track = playlist[index];
                audioPlayer.src = track.url;
                nowPlayingEl.textContent = track.name;
                mediaSourceEl.textContent = track.url;
                
                // Reset cover
                coverIcon.classList.remove('hidden');
                coverImage.classList.add('hidden');
                coverImage.src = '';
                
                if (isPlaying) {
                    audioPlayer.play();
                }
                
                updatePlaylistUI();
            }
            
            function togglePlay() {
                if (playlist.length === 0) return;
                
                if (currentTrackIndex === -1) {
                    currentTrackIndex = 0;
                    loadTrack(currentTrackIndex);
                }
                
                if (isPlaying) {
                    audioPlayer.pause();
                } else {
                    audioPlayer.play();
                }
            }
            
            function prevTrack() {
                if (playlist.length === 0) return;
                
                currentTrackIndex = (currentTrackIndex - 1 + playlist.length) % playlist.length;
                loadTrack(currentTrackIndex);
                if (isPlaying) {
                    audioPlayer.play();
                }
            }
            
            function nextTrack() {
                if (playlist.length === 0) return;
                
                currentTrackIndex = (currentTrackIndex + 1) % playlist.length;
                loadTrack(currentTrackIndex);
                if (isPlaying) {
                    audioPlayer.play();
                }
            }
            
            function updatePlayButton() {
                const icon = playBtn.querySelector('i');
                if (isPlaying) {
                    icon.classList.remove('fa-play');
                    icon.classList.add('fa-pause');
                } else {
                    icon.classList.remove('fa-pause');
                    icon.classList.add('fa-play');
                }
            }
            
            // Progress bar
            function updateProgress() {
                const { currentTime, duration } = audioPlayer;
                const progressPercent = (currentTime / duration) * 100;
                progressBar.style.width = `${progressPercent}%`;
                
                // Update time display
                currentTimeEl.textContent = formatTime(currentTime);
                
                if (!isNaN(duration)) {
                    durationEl.textContent = formatTime(duration);
                }
            }
            
            function setProgress(e) {
                const width = this.clientWidth;
                const clickX = e.offsetX;
                const duration = audioPlayer.duration;
                audioPlayer.currentTime = (clickX / width) * duration;
            }
            
            function formatTime(seconds) {
                const mins = Math.floor(seconds / 60);
                const secs = Math.floor(seconds % 60);
                return `${mins}:${secs < 10 ? '0' : ''}${secs}`;
            }
            
            // Volume control
            function setVolume() {
                audioPlayer.volume = this.value;
            }
            
            // Playback rate
            function setPlaybackRate() {
                audioPlayer.playbackRate = this.value;
            }
            
            // Media info
            function updateMediaInfo() {
                // Try to extract metadata or show filename
                const track = playlist[currentTrackIndex];
                nowPlayingEl.textContent = track.name;
                mediaSourceEl.textContent = track.url;
                
                // For audio files, we could try to fetch cover art here
                // This is a placeholder - in a real app you might use a metadata library
                if (track.url.match(/\.(mp3|ogg|wav)$/i)) {
                    // Could try to extract cover art from audio files
                }
            }
            
            // Input handling
            function addMediaFromInput() {
                const url = mediaUrlInput.value.trim();
                if (!url) return;
                
                addToPlaylist(url);
                mediaUrlInput.value = '';
            }
            
            function handleDrop(e) {
                const dt = e.dataTransfer;
                const files = dt.files;
                
                if (files.length > 0) {
                    // In a real app, you would handle file uploads here
                    // For this demo, we'll just show a message
                    alert('File upload would be handled here in a real app. For this demo, please use URLs.');
                }
            }
            
            // Sample playlist
            function loadSamplePlaylist() {
                if (playlist.length > 0 && !confirm('This will replace your current playlist. Continue?')) {
                    return;
                }
                
                playlist = [];
                currentTrackIndex = -1;
                
                // Add some sample tracks
                const samples = [
                    {
                        name: "Sample Audio 1",
                        url: "https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3"
                    },
                    {
                        name: "Sample Audio 2",
                        url: "https://www.soundhelix.com/examples/mp3/SoundHelix-Song-2.mp3"
                    },
                    {
                        name: "Sample Playlist (TXT)",
                        url: "https://example.com/playlist.txt" // This is a placeholder
                    }
                ];
                
                samples.forEach(sample => {
                    addToPlaylist(sample.url, sample.name);
                });
                
                alert('Sample playlist loaded. Note: The .txt example is a placeholder and won\'t actually work.');
            }
            
            // Initialize the player
            initPlayer();
        });
    </script>
</body>
</html>
